// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
Â  provider = "prisma-client-js"
}

datasource db {
Â  provider = "postgresql"
Â  urlÂ  Â  Â  Â  Â  = env("DATABASE_URL")
Â  relationMode = "prisma"
}

// ----------------------------------------------------
// ğŸ“Œ ãƒã‚¹ã‚¿ãƒ†ãƒ¼ãƒ–ãƒ« (ãƒ«ãƒƒã‚¯ã‚¢ãƒƒãƒ—)
// ----------------------------------------------------

// 1. æ€§åˆ¥ãƒ†ãƒ¼ãƒ–ãƒ« (Genders_Table)
model Gender {
Â  code IntÂ  Â  @id @map("gender_code")
Â  name String @map("gender_name") @db.VarChar(20)

Â  // ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
Â  accounts Account[]

Â  @@map("Genders_Table")
}

// 2. å¹´é½¢å±¤ãƒ†ãƒ¼ãƒ–ãƒ« (Age_Table)
model AgeGroup {
Â  code IntÂ  Â  @id @map("age_group_code")
Â  name String @map("age_group_name") @db.VarChar(20)

Â  // ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
Â  accounts Account[]

Â  @@map("Age_Table")
}

// 3. è·æ¥­ãƒ†ãƒ¼ãƒ–ãƒ« (Occupations_Table)
model Occupation {
Â  code IntÂ  Â  @id @map("occupation_code")
Â  name String @map("occupation_name") @db.VarChar(50)

Â  // ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
Â  accounts Account[]

Â  @@map("Occupations_Table")
}

// ----------------------------------------------------
// ğŸ‘¥ ãƒ¦ãƒ¼ã‚¶ãƒ¼/å‡ºåº—è€…ãƒ†ãƒ¼ãƒ–ãƒ« (Accounts_Table)
// ----------------------------------------------------

// 4. åˆ©ç”¨è€…/å‡ºåº—è€…ãƒ†ãƒ¼ãƒ–ãƒ« (Accounts_Tableã¨ã—ã¦çµ±åˆ)
model Account {
Â  // â˜…ä¸»ã‚­ãƒ¼: ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ (String)
Â  emailÂ  Â  Â  Â  Â StringÂ  Â  @id @map("email") @db.VarChar(255)Â 
Â  nicknameÂ  Â  Â  StringÂ  Â  @unique @db.VarChar(50)
Â  accountTypeÂ  Â StringÂ  Â  @map("account_type") @db.VarChar(10)
Â  storeNameÂ  Â  Â String?Â  Â @map("store_name") @db.VarChar(100)
Â  introductionÂ  String?Â  Â @db.Text
Â Â 
Â  // å¤–éƒ¨ã‚­ãƒ¼
Â  genderCodeÂ  Â  Int?Â  Â  Â  @map("gender_code")
Â  ageGroupCodeÂ  Int?Â  Â  Â  @map("age_group_code")
Â  occupationCode Int?Â  Â  Â @map("occupation_code")

Â  // ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚·ãƒƒãƒ— (ãƒã‚¹ã‚¿ãƒ†ãƒ¼ãƒ–ãƒ«å‚ç…§)
Â  genderÂ  Â  Â  Â  Gender?Â  Â  @relation(fields: [genderCode], references: [code])
Â  ageGroupÂ  Â  Â  AgeGroup?Â  @relation(fields: [ageGroupCode], references: [code])
Â  occupationÂ  Â  Occupation? @relation(fields: [occupationCode], references: [code])
Â Â 
Â  // ä¾å­˜ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ (å¤–éƒ¨ã‚­ãƒ¼ã‚’æŒã¤ãƒ†ãƒ¼ãƒ–ãƒ«)
Â  locationsÂ  Â  Â Location[]
Â  commentsÂ  Â  Â  Comment[]
Â  likesÂ  Â  Â  Â  Â Like[]

Â  @@map("Accounts_Table")
}

// ----------------------------------------------------
// ğŸ“ ä½ç½®æƒ…å ±ãƒ»æŠ•ç¨¿ãƒ»ã„ã„ã­ ãƒ†ãƒ¼ãƒ–ãƒ«
// ----------------------------------------------------

// 5. å‡ºåº—è€…ä½ç½®æƒ…å ±ãƒ†ãƒ¼ãƒ–ãƒ« (Locations_Table)
model Location {
Â  idÂ  Â  Â  Â  Â  Â  IntÂ  Â  Â  Â @id @default(autoincrement()) @map("location_id")
Â  // â˜…å¤–éƒ¨ã‚­ãƒ¼: Stringå‹ã«å¤‰æ›´ã—ã€Account.emailã‚’å‚ç…§
Â  accountIdÂ  Â  Â StringÂ  Â  @map("account_email")Â 

Â  latitudeÂ  Â  Â  DecimalÂ  Â  Â @db.Decimal(10, 8)
Â  longitudeÂ  Â  Â DecimalÂ  Â  Â @db.Decimal(11, 8)
Â  openingDateÂ  Â DateTimeÂ  @map("opening_date") @db.Date
Â  locationNameÂ  String?Â  Â @map("location_name") @db.VarChar(100)

Â  // ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚·ãƒƒãƒ—
Â  accountÂ  Â  Â  Â AccountÂ  Â @relation(fields: [accountId], references: [email])
Â Â 
Â  @@map("Locations_Table")
}

// 6. ã‚³ãƒ¡ãƒ³ãƒˆæŠ•ç¨¿ãƒ†ãƒ¼ãƒ–ãƒ« (Comments_Table)
model Comment {
Â  idÂ  Â  Â  Â  Â  Â  IntÂ  Â  Â  Â @id @default(autoincrement()) @map("comment_id")
Â  // â˜…å¤–éƒ¨ã‚­ãƒ¼: Stringå‹ã«å¤‰æ›´ã—ã€Account.emailã‚’å‚ç…§
Â  accountIdÂ  Â  Â StringÂ  Â  @map("account_email")Â 

Â  latitudeÂ  Â  Â  DecimalÂ  Â  Â @db.Decimal(10, 8)
Â  longitudeÂ  Â  Â DecimalÂ  Â  Â @db.Decimal(11, 8)
Â  commentTextÂ  Â StringÂ  Â  @map("comment_text") @db.Text
Â  postedAtÂ  Â  Â  DateTimeÂ  @map("posted_at") @default(now())

Â  // ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚·ãƒƒãƒ—
Â  accountÂ  Â  Â  Â AccountÂ  Â @relation(fields: [accountId], references: [email])
Â  likesÂ  Â  Â  Â  Â Like[]Â 

Â  @@map("Comments_Table")
}

// 7. ã„ã„ã­ãƒ†ãƒ¼ãƒ–ãƒ« (Likes_Table) - è¤‡åˆä¸»ã‚­ãƒ¼
model Like {
Â  commentIdÂ  Â  Â IntÂ  Â  Â  Â @map("comment_id")
Â  // â˜…å¤–éƒ¨ã‚­ãƒ¼: Stringå‹ã«å¤‰æ›´ã—ã€Account.emailã‚’å‚ç…§
Â  accountIdÂ  Â  Â StringÂ  Â  @map("account_email")Â 
Â  likedAtÂ  Â  Â  Â DateTimeÂ  @map("liked_at") @default(now())

Â  // ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚·ãƒƒãƒ—
Â  commentÂ  Â  Â  Â CommentÂ  Â @relation(fields: [commentId], references: [id]) // Commentã®IDã¯Intå‹ã§å¤‰æ›´ãªã—
Â  accountÂ  Â  Â  Â AccountÂ  Â @relation(fields: [accountId], references: [email]) // Accountã®ä¸»ã‚­ãƒ¼ã‚’å‚ç…§

Â  // è¤‡åˆä¸»ã‚­ãƒ¼ (ã‚³ãƒ¡ãƒ³ãƒˆIDã¨ã‚¢ã‚«ã‚¦ãƒ³ãƒˆIDã®çµ„ã¿åˆã‚ã›ã§ä¸€æ„)
Â  @@id([commentId, accountId])
Â  @@map("Likes_Table")
}